container <- reactive({
if(input$valueselector == 'All'){
container <- values_raw
container
} else
container <- values_raw[values_raw$Affiliation == input$valueselector,]
container
})
output$chart3 <- renderPlotly({
plot_ly(values(),x=values()$n,y=values()$value,type='bar') %>%
layout(margin = list(l = 200, pad = 4), font=list(size=12),
title ='How PCOE core values could be improved.',
xaxis=list(title='Number of responses'))
})
output$table3 <- renderDataTable({
category <- event_data('plotly_click')$y
datatable(container()[container()$value == category,c(4,6)],escape = F)
})
}
shinyApp(ui, server)
library(reshape2)
library(readxl)
library(dplyr)
library(plotly)
library(shiny)
library(DT)
mission <- read_xlsx('text.xlsx', sheet = 'Mission')
mission <- melt(mission,id.vars = c('Affiliation','Category','Q4: Mission relevant',
'Q5: Mission'))
mission_raw <- mission[complete.cases(mission),]
temp <- mission_raw %>% group_by(value, Affiliation) %>% summarise(n = n())
ui <- fluidPage(
selectInput('selector',label = "Respondent:", choices = c('All','Student','Faculty','Staff', 'Alumni'), selected = "All",width = '20%'),
plotlyOutput('chart'),
dataTableOutput('table')
)
server <- function(input, output,session){
mission <- reactive({
if(input$selector == 'All'){
temp <- temp  %>% group_by(value) %>% summarise(n=sum(n))
temp$value <- factor(temp$value, levels = unique(temp$value)[order(temp$n, decreasing = FALSE)])
temp
} else{
temp <- temp[temp$Affiliation == input$selector,]
temp$value <- factor(temp$value, levels = unique(temp$value)[order(temp$n, decreasing = FALSE)])
temp
}
})
container <- reactive({
if(input$selector == 'All'){
container <- mission_raw
container
} else
container <- mission_raw[mission_raw$Affiliation == input$selector,]
container
})
output$chart <- renderPlotly({
plot_ly(mission(),x=mission()$n,y=mission()$value,type ='bar') %>%
layout(margin = list(l = 200, pad = 4), font=list(size=12),
title ='How PCOE mission could be improved.',
xaxis=list(title='Number of responses'))
})
output$table <-renderDataTable({category <- event_data('plotly_click')$y
datatable(container()[container()$value==category,c(4,6)], escape=F)
})
}
shinyApp(ui, server)
install.packages("shinythemes")
vision <- read_xlsx('text.xlsx', sheet = 'Vision')
vision <- melt(vision,id.vars = c('Affiliation','Category','Q7: Vision relevant',
'Q11: Vision'))
vision_raw <- vision[complete.cases(vision),]
temp_v <- vision %>% group_by(value,Affiliation) %>% summarise(n = n())
ui <- fluidPage(
shinythemes::themeSelector(),
selectInput('visionselector',label = "Respondent:", choices =
c('All','Student','Faculty','Staff', 'Alumni'), selected = "All",width = '20%'),
plotlyOutput('chart2'),
dataTableOutput('table2')
)
server <- function(input, output,...){
vision <- reactive({
if(input$visionselector == 'All'){
temp_v <- temp_v  %>% group_by(value) %>% summarise(n=sum(n))
temp_v$value <- factor(temp_v$value, levels = unique(temp_v$value)[order(temp_v$n, decreasing = FALSE)])
temp_v
} else{
temp_v <- temp_v[temp_v$Affiliation == input$visionselector,]
temp_v$value <- factor(temp_v$value, levels = unique(temp_v$value)[order(temp_v$n, decreasing = FALSE)])
temp_v
}
})
container <- reactive({
if(input$visionselector == 'All'){
container <- vision_raw
container
} else {
container <- vision_raw[vision_raw$Affiliation == input$visionselector,]
container
}
})
output$chart2 <- renderPlotly({
plot_ly(vision(),x=vision()$n,y=vision()$value,type='bar') %>%
layout(margin = list(l = 200, pad = 4), font=list(size=12),
title ='How PCOE vision could be improved.',
xaxis=list(title='Number of responses'))
})
output$table2 <- renderDataTable({category <- event_data('plotly_click')$y
datatable(container()[container()$value == category,c(4,6)],escape=F)
})
}
shinyApp(ui, server)
values <- read_xlsx('text.xlsx', sheet = 'Values')
values <- melt(values,id.vars = c('Affiliation','Category','Q10: Relavant',
'Q8: Values'))
values_raw <- values[complete.cases(values),]
temp_vl <- values %>% group_by(value,Affiliation) %>% summarise(n = n())
ui <- fluidPage(
selectInput('valueselector',label = "Respondent:",
choices = c('All','Student','Faculty','Staff', 'Alumni'),
selected = "All",width = '20%'),
plotlyOutput('chart3'),
dataTableOutput('table3')
)
server <- function(input, output,...){
values <- reactive({
if(input$valueselector == 'All'){
temp_vl <- temp_vl  %>% group_by(value) %>% summarise(n=sum(n))
temp_vl$value <- factor(temp_vl$value, levels = unique(temp_vl$value)[order(temp_vl$n, decreasing = FALSE)])
temp_vl
} else{
temp_vl <- temp_vl[temp_vl$Affiliation == input$valueselector,]
temp_vl$value <- factor(temp_vl$value, levels = unique(temp_vl$value)[order(temp_vl$n, decreasing = FALSE)])
temp_vl
}
})
container <- reactive({
if(input$valueselector == 'All'){
container <- values_raw
container
} else
container <- values_raw[values_raw$Affiliation == input$valueselector,]
container
})
output$chart3 <- renderPlotly({
plot_ly(values(),x=values()$n,y=values()$value,type='bar') %>%
layout(margin = list(l = 200, pad = 4), font=list(size=12),
title ='Improving PCOE core values.',
xaxis=list(title='Number of responses'),
yaxis=list(title='Topics'))
})
output$table3 <- renderDataTable({
category <- event_data('plotly_click')$y
datatable(container()[container()$value == category,c(4,6)],escape = F)
})
}
shinyApp(ui, server)
values <- read_xlsx('text.xlsx', sheet = 'Values')
values <- melt(values,id.vars = c('Affiliation','Category','Q10: Relavant',
'Q8: Values'))
values_raw <- values[complete.cases(values),]
temp_vl <- values %>% group_by(value,Affiliation) %>% summarise(n = n())
ui <- fluidPage(
selectInput('valueselector',label = "Respondent:",
choices = c('All','Student','Faculty','Staff', 'Alumni'),
selected = "All",width = '20%'),
plotlyOutput('chart3'),
dataTableOutput('table3')
)
server <- function(input, output,...){
values <- reactive({
if(input$valueselector == 'All'){
temp_vl <- temp_vl  %>% group_by(value) %>% summarise(n=sum(n))
temp_vl$value <- factor(temp_vl$value, levels = unique(temp_vl$value)[order(temp_vl$n, decreasing = FALSE)])
temp_vl
} else{
temp_vl <- temp_vl[temp_vl$Affiliation == input$valueselector,]
temp_vl$value <- factor(temp_vl$value, levels = unique(temp_vl$value)[order(temp_vl$n, decreasing = FALSE)])
temp_vl
}
})
container <- reactive({
if(input$valueselector == 'All'){
container <- values_raw
container
} else
container <- values_raw[values_raw$Affiliation == input$valueselector,]
container
})
output$chart3 <- renderPlotly({
plot_ly(values(),x=values()$n,y=values()$value,type='bar') %>%
layout(margin = list(l = 200, pad = 4), font=list(size=12),
title =paste0('Improving PCOE core values: ',input$valueselector),
xaxis=list(title='Number of responses'))
})
output$table3 <- renderDataTable({
category <- event_data('plotly_click')$y
datatable(container()[container()$value == category,c(4,6)],escape = F)
})
}
shinyApp(ui, server)
library(reshape2)
library(readxl)
library(dplyr)
library(plotly)
library(shiny)
library(DT)
mission <- read_xlsx('text.xlsx', sheet = 'Mission')
mission <- melt(mission,id.vars = c('Affiliation','Category','Q4: Mission relevant',
'Q5: Mission'))
mission_raw <- mission[complete.cases(mission),]
temp <- mission_raw %>% group_by(value, Affiliation) %>% summarise(n = n())
ui <- fluidPage(
selectInput('selector',label = "Respondent:", choices =
c('All respondents','Students','Faculty','Staff', 'Alumni'),
selected = "All respondents",width = '20%'),
plotlyOutput('chart'),
dataTableOutput('table')
)
server <- function(input, output,session){
mission <- reactive({
if (input$selector == 'All respondents') {
temp <- temp  %>% group_by(value) %>% summarise(n = sum(n))
temp$value <- factor(temp$value, levels = unique(temp$value)[order(temp$n, decreasing = FALSE)])
temp
} else{
temp <- temp[temp$Affiliation == input$selector,]
temp$value <- factor(temp$value, levels = unique(temp$value)[order(temp$n, decreasing = FALSE)])
temp
}
})
container <- reactive({
if (input$selector == 'All respondents') {
container <- mission_raw
container
} else
container <- mission_raw[mission_raw$Affiliation == input$selector,]
container
})
output$chart <- renderPlotly({
plot_ly(mission(),
x = mission()$n,
y = mission()$value,
type = 'bar') %>%
layout(
margin = list(l = 200, pad = 4),
font = list(size = 12),
title = paste0('Improving PCOE mission: ', input$selector),
xaxis = list(title = 'Number of responses')
)
})
output$table <- renderDataTable({
category <- event_data('plotly_click')$y
datatable(container()[container()$value == category, c(4, 6)], escape = F,
options = list(dom = 't'))
})
}
shinyApp(ui, server)
library(reshape2)
library(readxl)
library(dplyr)
library(plotly)
library(shiny)
library(DT)
mission <- read_xlsx('text.xlsx', sheet = 'Mission')
mission <- melt(mission,id.vars = c('Affiliation','Category','Q4: Mission relevant',
'Q5: Mission'))
mission_raw <- mission[complete.cases(mission),]
temp <- mission_raw %>% group_by(value, Affiliation) %>% summarise(n = n())
ui <- fluidPage(
selectInput('selector',label = "Respondent:", choices =
c('All respondents','Students','Faculty','Staff', 'Alumni'),
selected = "All respondents",width = '20%'),
plotlyOutput('chart'),
dataTableOutput('table')
)
server <- function(input, output,session){
mission <- reactive({
if (input$selector == 'All respondents') {
temp <- temp  %>% group_by(value) %>% summarise(n = sum(n))
temp$value <- factor(temp$value, levels = unique(temp$value)[order(temp$n, decreasing = FALSE)])
temp
} else{
temp <- temp[temp$Affiliation == input$selector,]
temp$value <- factor(temp$value, levels = unique(temp$value)[order(temp$n, decreasing = FALSE)])
temp
}
})
container <- reactive({
if (input$selector == 'All respondents') {
container <- mission_raw
container
} else
container <- mission_raw[mission_raw$Affiliation == input$selector,]
container
})
output$chart <- renderPlotly({
plot_ly(mission(),
x = mission()$n,
y = mission()$value,
type = 'bar') %>%
layout(
margin = list(l = 200, pad = 4),
font = list(size = 12),
title = paste0('Improving PCOE mission: ', input$selector),
xaxis = list(title = 'Number of responses')
)
})
output$table <- renderDataTable({
category <- event_data('plotly_click')$y
datatable(container()[container()$value == category, c(4, 6)],
colnames = c("Comment","Topic"),
escape = F,
options = list(dom = 't'))
})
}
shinyApp(ui, server)
library(dplyr)
library(readxl)
library(dplyr)
library(tidyr)
q <- read_excel("Raw data.xlsx")
View(q)
q %>% select(`Response ID`,`Q8 - Topics`, `Q11 - Topics`,`Q5 - Topics`)
q %>% select(`Response ID`,`Q8 - Topics`, `Q11 - Topics`,`Q5 - Topics`) %>%
gather()
q %>% select(`Response ID`,`Q8 - Topics`, `Q11 - Topics`,`Q5 - Topics`) %>%
gather(key = `Response ID`)
q %>% select(`Response ID`,`Q8 - Topics`, `Q11 - Topics`,`Q5 - Topics`) %>%
gather(key = `Response ID`)
length(unique(q$`Response ID`))
q %>% select(`Response ID`,`Q8 - Topics`, `Q11 - Topics`,`Q5 - Topics`) %>%
gather(key = `Response ID`,"topic",2:3)
q %>% select(`Response ID`,`Q8 - Topics`, `Q11 - Topics`,`Q5 - Topics`) %>%
gather(key = `Response ID`,"topic",2)
q %>% select(`Response ID`,`Q8 - Topics`, `Q11 - Topics`,`Q5 - Topics`) %>%
gather(key = `Response ID`,value = "topic",`Q5 - Topics`)
q %>% select(`Response ID`,`Q8 - Topics`, `Q11 - Topics`,`Q5 - Topics`) %>%
gather(key = `Response ID`,value = "topic",`Q5 - Topics`)
q %>% select(`Response ID`,`Q8 - Topics`, `Q11 - Topics`,`Q5 - Topics`) %>%
gather(value = "topic",`Q5 - Topics`)
q %>% select(`Response ID`,`Q8 - Topics`, `Q11 - Topics`,`Q5 - Topics`) %>%
gather()
q %>% select(`Response ID`,`Q8 - Topics`, `Q11 - Topics`,`Q5 - Topics`) %>%
gather(`Response ID`)
temp <- q %>% select(`Response ID`,`Q8 - Topics`, `Q11 - Topics`,`Q5 - Topics`) %>%
temp <- q %>% select(`Response ID`,`Q8 - Topics`, `Q11 - Topics`,`Q5 - Topics`)
View(temp)
temp %>% gather()
temp %>% gather(`Response ID`)
temp %>% gather(`Response ID`, "themes",2:4)
temp %>% gather(`Response ID`, "themes",2:4,na.rm = TRUE)
temp %>% gather( "themes",2:4,na.rm = TRUE)
temp %>% gather( "Response ID",2:4,na.rm = TRUE)
temp %>% gather( "Response ID",'topic',2:4,na.rm = TRUE)
temp %>% gather( "ID",'topic',2:4,na.rm = TRUE)
tmp <- temp %>% gather( "ID",'topic',2:4,na.rm = TRUE)
View(tmp)
View(tmp)
View(tmp)
View(tmp)
tmp <- temp %>% gather( "Topic",'comment',2:4,na.rm = TRUE)
View(tmp)
tmp %>% distinct(`Response ID`)
View(tmp)
length(unique(tmp$`Response ID`))
View(tmp)
tmp <- temp %>% gather( "Topic",'comment',2:4,na.rm = TRUE)  %>%
filter(!comment %in% ('Not Applicable',"Unknown"))
tmp <- temp %>% gather( "Topic",'comment',2:4,na.rm = TRUE)  %>%
filter(!comment %in% c('Not Applicable',"Unknown"))
View(tmp)
tmp %>% count(distinct(`Response ID`))
tmp %>% distinct(`Response ID`)
tmp %>% count(`Response ID`)
q <- read_excel("Raw data.xlsx")
temp <- q %>% select(`Response ID`,affiliation,`Q8 - Topics`, `Q11 - Topics`,`Q5 - Topics`)
q <- read_excel("Raw data.xlsx")
q <- q %>% select(`Response ID`,affiliation,`Q8 - Topics`, `Q11 - Topics`,`Q5 - Topics`)
View(q)
temp %>% gather( "Topic",'comment',2:4,na.rm = TRUE)  %>%
filter(!comment %in% c('Not Applicable',"Unknown"))
q%>% gather( "Topic",'comment',2:4,na.rm = TRUE)  %>%
filter(!comment %in% c('Not Applicable',"Unknown"))
View(q)
tmp <- q%>% gather( "Topic",'comment',2:5,na.rm = TRUE)  %>%
filter(!comment %in% c('Not Applicable',"Unknown"))
View(tmp)
View(q)
View(tmp)
tmp <- q%>% gather( "Topic",'comment',3:5,na.rm = TRUE)  %>%
filter(!comment %in% c('Not Applicable',"Unknown"))
tmp %>% count(`Response ID`)
tmp %>% count(affiliation)
tmp %>% distinct(`Response ID`,.keep_all = TRUE) %>% count(affiliation)
11+34+84
View(tmp)
tmp %>% group_by(Topic) %>%  distinct(`Response ID`,.keep_all = TRUE) %>% count(affiliation)
tmp %>% group_by(Topic) %>%  distinct(`Response ID`,.keep_all = TRUE) %>%
spread(Topic)
tmp %>% group_by(Topic) %>% summarise(n=n()) %>%  distinct(`Response ID`,.keep_all = TRUE) %>%
spread(Topic,n)
View(tmp)
tmp %>% group_by(Topic) %>% summarise(n=n()) %>%  distinct(`Response ID`,.keep_all = TRUE) %>%
spread(affiliation,n)
tmp %>% group_by(Topic, affiliation) %>% summarise(n=n()) %>%
distinct(`Response ID`,.keep_all = TRUE) %>%
spread(affiliation,n)
tmp %>%  distinct(`Response ID`,.keep_all = TRUE) %>%
group_by(Topic, affiliation) %>% summarise(n=n()) %>%
spread(affiliation,n)
tmp %>%  distinct(`Response ID`,.keep_all = TRUE) %>%
group_by(Topic, affiliation) %>% summarise(n=n()) %>%
spread(Topic,n)
library(readxl)
library(dplyr)
library(tidyr)
q <- read_excel("Raw data.xlsx")
q <- q %>% select(`Response ID`,affiliation,`Q8 - Topics`, `Q11 - Topics`,`Q5 - Topics`)
tmp <- q%>% gather( "Topic",'comment',3:5,na.rm = TRUE)  %>%
filter(!comment %in% c('Not Applicable',"Unknown"))
#breakdown by respondents - across all three items
total <- tmp %>% distinct(`Response ID`,.keep_all = TRUE) %>% count(affiliation)
#breakdown by respondents and by each item
by_q <- tmp %>%  distinct(`Response ID`,.keep_all = TRUE) %>%
group_by(Topic, affiliation) %>% summarise(n=n()) %>%
spread(Topic,n)
View(total)
View(total)
View(by_q)
by_q <- tmp %>%  distinct(`Response ID`,.keep_all = TRUE) %>%
group_by(Topic, affiliation) %>% summarise(n=n()) %>%
spread(Topic,n) %>% rename(c('Vision','Mission','Values'))
by_q <- tmp %>%  distinct(`Response ID`,.keep_all = TRUE) %>%
group_by(Topic, affiliation) %>% summarise(n=n()) %>%
spread(Topic,n) %>% setNames(c('affiliation','Vision','Mission','Values'))
View(by_q)
write.csv(by_q,file="clipboard",row.names = F)
tmp %>%
group_by(Topic, affiliation) %>% summarise(n=n()) %>%
spread(Topic,n) %>% setNames(c('affiliation','Vision','Mission','Values'))
32+66
27+43
by_q <- tmp %>%  distinct(`Response ID`,.keep_all = TRUE) %>%
group_by(Topic, affiliation) %>% summarise(n=n()) %>%
spread(Topic,n)
View(by_q)
tmp %>%
group_by(Topic, affiliation) %>% summarise(n=n()) %>%
spread(Topic,n)
by_q <- tmp %>%
group_by(Topic, affiliation) %>% summarise(n=n()) %>%
spread(Topic,n)
View(by_q)
total <- tmp %>% distinct(`Response ID`,.keep_all = TRUE) %>% count(affiliation)
View(total)
View(q)
q %>% count(`Q5 - Topics`)
View(q)
library(readxl)
library(dplyr)
library(tidyr)
q <- read_excel("Raw data.xlsx")
q <- q %>% select(`Response ID`,affiliation,`Provide input as to how you believe the mission statement could be improved.`,
`Provide input as to how you believe the vision statement could be improved.`,
`Provide input as to how you believe the core values could be improved.`)
q <- read_excel("Raw data.xlsx")
q <- q %>% select(`Response ID`,affiliation,`Provide input as to how you believe the mission statement could be improved.`,
`Provide input as to how you believe the vision statement could be improved.`,
`Provide input as to how you believe the core values could be improved.`) %>%
setNames(c('Id','affiliation','mission','vision','values'))
View(q)
tmp <- q%>% gather( "Topic",'comment',3:5,na.rm = TRUE)
View(tmp)
tmp %>% distinct(`Response ID`,.keep_all = TRUE) %>% count(affiliation)
View(tmp)
View(q)
View(tmp)
View(tmp)
View(tmp)
tmp <- q%>% gather( "Topic",'comment',3:5,na.rm = TRUE) %>%
filter(!comment %in% c('n/a'))
View(tmp)
q <- read_excel("Raw data.xlsx")
q <- q %>% select(`Response ID`,affiliation,`Provide input as to how you believe the mission statement could be improved.`,
`Provide input as to how you believe the vision statement could be improved.`,
`Provide input as to how you believe the core values could be improved.`) %>%
setNames(c('Id','affiliation','mission','vision','values'))
tmp <- q%>% gather( "Topic",'comment',3:5,na.rm = TRUE) %>%
filter(!comment %in% c('n/a', 'N/A'))
View(tmp)
View(tmp)
q <- read_excel("Raw data.xlsx")
q <- q %>% select(`Response ID`,affiliation,`Provide input as to how you believe the mission statement could be improved.`,
`Provide input as to how you believe the vision statement could be improved.`,
`Provide input as to how you believe the core values could be improved.`) %>%
setNames(c('Id','affiliation','mission','vision','values'))
tmp <- q%>% gather( "Topic",'comment',3:5,na.rm = TRUE) %>%
filter(!comment %in% c('n/a', 'N/A','n/A','N/a'))
View(tmp)
tmp %>% distinct(`Response ID`,.keep_all = TRUE) %>% count(affiliation)
18+68+161
tmp %>% distinct(Id,.keep_all = TRUE) %>% count(affiliation)
11+34+85
tmp %>%
group_by(Topic, affiliation) %>% summarise(n=n()) %>%
spread(Topic,n)
View(tmp)
View(q)
View(tmp)
32+67
tmp %>% count(Topic)
